var t={};class e{static STATUS={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.status=e.STATUS.idle,this.score=0,this.state=t.map(t=>[...t]),this.initialState=t}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=e.STATUS.playing,this.addRandomTile(),this.addRandomTile()}restart(){this.status=e.STATUS.idle,this.state=this.initialState.map(t=>[...t]),this.score=0}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);if(t.length>0){let e=Math.floor(Math.random()*t.length),[s,i]=t[e];this.state[s][i]=.9>=Math.random()?2:4}}moveLeft(){this.move(t=>t,(t,e)=>this.state[e]=t)}moveRight(){this.move(t=>t.reverse(),(t,e)=>this.state[e]=t.reverse())}moveUp(){this.status===e.STATUS.playing&&this.move((t,e)=>this.getColumn(e),(t,e)=>this.setColumn(t,e))}moveDown(){this.status===e.STATUS.playing&&this.move((t,e)=>this.getColumn(e).reverse(),(t,e)=>this.setColumn(t.reverse(),e))}move(t,s){if(this.status!==e.STATUS.playing)return;let i=!1;for(let e=0;e<4;e++){let a=t(this.state[e],e),[n]=this.combineAndShift(a);n.toString()!==a.toString()&&(i=!0),s(n,e)}i&&(this.addRandomTile(),this.checkLoseOrWin())}getColumn(t){return this.state.map(e=>e[t])}setColumn(t,e){t.forEach((t,s)=>{this.state[s][e]=t})}combineAndShift(t){let e=t.filter(t=>0!==t),s=!1;for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0,s=!0);for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);return[e,s]}canMove(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e]||e<3&&this.state[t][e]===this.state[t][e+1]||t<3&&this.state[t][e]===this.state[t+1][e])return!0;return!1}checkLoseOrWin(){for(let t=0;t<4;t++)for(let s=0;s<4;s++)if(2048===this.state[t][s]){this.status=e.STATUS.win;return}this.canMove()||(this.status=e.STATUS.lose)}}const s=new(t=e),i=document.getElementsByClassName("game-field")[0],a=document.getElementsByClassName("button start")[0],n=document.getElementsByClassName("game-score")[0],o=document.getElementsByClassName("message-start")[0],l=document.getElementsByClassName("message-lose")[0],r=document.getElementsByClassName("message-win")[0];function h(){n.textContent=s.getScore()}function m(){let e=s.getStatus();e===t.STATUS.win?r.classList.remove("hidden"):e===t.STATUS.lose&&l.classList.remove("hidden")}function d(){i.innerHTML="",s.getState().forEach(t=>{let e=document.createElement("tr");t.forEach(t=>{let s=document.createElement("td");0!==t?s.textContent=t:s.textContent="",s.className=`field-cell${t?` field-cell--${t}`:""}`,e.appendChild(s)}),i.appendChild(e)})}a.addEventListener("click",()=>{let t=a.classList.contains("start");t?(s.start(),a.textContent="Restart"):(s.restart(),a.textContent="Start"),a.classList.toggle("start"),a.classList.toggle("restart"),o.classList.add("hidden"),l.classList.add("hidden"),r.classList.add("hidden"),t||o.classList.remove("hidden"),d(),h(),m()}),document.addEventListener("keydown",t=>{let e={ArrowRight:"moveRight",ArrowLeft:"moveLeft",ArrowUp:"moveUp",ArrowDown:"moveDown"};e[t.key]&&(s[e[t.key]](),d(),h(),m())});
//# sourceMappingURL=index.52fc005b.js.map
